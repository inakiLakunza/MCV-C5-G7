1
The device we will be working on is: cuda
[02/29 17:31:04 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from https://dl.fbaipublicfiles.com/detectron2/COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x/137849600/model_final_f10217.pkl ...
Creating dataset
[02/29 17:31:07 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from https://dl.fbaipublicfiles.com/detectron2/COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x/137849600/model_final_f10217.pkl ...
Evaluating model
[02/29 17:31:07 d2.evaluation.coco_evaluation]: Trying to convert 'KITTI-MOTS-COCO_val' to COCO format ...
WARNING [02/29 17:31:07 d2.data.datasets.coco]: Using previously cached COCO format annotations at 'outputs_prueba/COCO-InstanceSegmentation/KITTI-MOTS-COCO_val_coco_format.json'. You need to clear the cache file if your dataset has been modified.
[02/29 17:31:09 d2.data.build]: Distribution of instances among all 81 categories:
|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
| pedestrian | 3347         |            | 0            |    car     | 8021         |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |    sink    | 2765         |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            |            | 0            |
|            | 0            |            | 0            | background | 0            |
|            |              |            |              |            |              |
|   total    | 14133        |            |              |            |              |
[02/29 17:31:09 d2.data.dataset_mapper]: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[02/29 17:31:09 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[02/29 17:31:09 d2.data.common]: Serializing 2919 elements to byte tensors and concatenating them all ...
[02/29 17:31:09 d2.data.common]: Serialized dataset takes 5.86 MiB
[02/29 17:31:09 d2.evaluation.evaluator]: Start inference on 2919 batches
[02/29 17:31:13 d2.evaluation.evaluator]: Inference done 11/2919. Dataloading: 0.0031 s/iter. Inference: 0.0541 s/iter. Eval: 0.0074 s/iter. Total: 0.0646 s/iter. ETA=0:03:07
[02/29 17:31:18 d2.evaluation.evaluator]: Inference done 110/2919. Dataloading: 0.0032 s/iter. Inference: 0.0405 s/iter. Eval: 0.0074 s/iter. Total: 0.0514 s/iter. ETA=0:02:24
[02/29 17:31:23 d2.evaluation.evaluator]: Inference done 214/2919. Dataloading: 0.0032 s/iter. Inference: 0.0392 s/iter. Eval: 0.0072 s/iter. Total: 0.0498 s/iter. ETA=0:02:14
[02/29 17:31:28 d2.evaluation.evaluator]: Inference done 323/2919. Dataloading: 0.0032 s/iter. Inference: 0.0385 s/iter. Eval: 0.0066 s/iter. Total: 0.0484 s/iter. ETA=0:02:05
[02/29 17:31:33 d2.evaluation.evaluator]: Inference done 432/2919. Dataloading: 0.0034 s/iter. Inference: 0.0386 s/iter. Eval: 0.0057 s/iter. Total: 0.0478 s/iter. ETA=0:01:58
[02/29 17:31:38 d2.evaluation.evaluator]: Inference done 543/2919. Dataloading: 0.0034 s/iter. Inference: 0.0387 s/iter. Eval: 0.0051 s/iter. Total: 0.0473 s/iter. ETA=0:01:52
[02/29 17:31:43 d2.evaluation.evaluator]: Inference done 654/2919. Dataloading: 0.0033 s/iter. Inference: 0.0386 s/iter. Eval: 0.0049 s/iter. Total: 0.0469 s/iter. ETA=0:01:46
[02/29 17:31:48 d2.evaluation.evaluator]: Inference done 763/2919. Dataloading: 0.0033 s/iter. Inference: 0.0386 s/iter. Eval: 0.0048 s/iter. Total: 0.0468 s/iter. ETA=0:01:40
[02/29 17:31:53 d2.evaluation.evaluator]: Inference done 871/2919. Dataloading: 0.0032 s/iter. Inference: 0.0387 s/iter. Eval: 0.0047 s/iter. Total: 0.0467 s/iter. ETA=0:01:35
[02/29 17:31:58 d2.evaluation.evaluator]: Inference done 980/2919. Dataloading: 0.0032 s/iter. Inference: 0.0387 s/iter. Eval: 0.0047 s/iter. Total: 0.0466 s/iter. ETA=0:01:30
[02/29 17:32:03 d2.evaluation.evaluator]: Inference done 1090/2919. Dataloading: 0.0032 s/iter. Inference: 0.0386 s/iter. Eval: 0.0047 s/iter. Total: 0.0465 s/iter. ETA=0:01:25
[02/29 17:32:08 d2.evaluation.evaluator]: Inference done 1198/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0046 s/iter. Total: 0.0465 s/iter. ETA=0:01:20
[02/29 17:32:13 d2.evaluation.evaluator]: Inference done 1306/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0046 s/iter. Total: 0.0465 s/iter. ETA=0:01:15
[02/29 17:32:18 d2.evaluation.evaluator]: Inference done 1415/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0047 s/iter. Total: 0.0465 s/iter. ETA=0:01:09
[02/29 17:32:23 d2.evaluation.evaluator]: Inference done 1518/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0048 s/iter. Total: 0.0467 s/iter. ETA=0:01:05
[02/29 17:32:28 d2.evaluation.evaluator]: Inference done 1623/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0049 s/iter. Total: 0.0468 s/iter. ETA=0:01:00
[02/29 17:32:33 d2.evaluation.evaluator]: Inference done 1725/2919. Dataloading: 0.0031 s/iter. Inference: 0.0387 s/iter. Eval: 0.0050 s/iter. Total: 0.0469 s/iter. ETA=0:00:56
[02/29 17:32:38 d2.evaluation.evaluator]: Inference done 1815/2919. Dataloading: 0.0031 s/iter. Inference: 0.0388 s/iter. Eval: 0.0053 s/iter. Total: 0.0474 s/iter. ETA=0:00:52
[02/29 17:32:43 d2.evaluation.evaluator]: Inference done 1912/2919. Dataloading: 0.0031 s/iter. Inference: 0.0388 s/iter. Eval: 0.0056 s/iter. Total: 0.0476 s/iter. ETA=0:00:47
[02/29 17:32:48 d2.evaluation.evaluator]: Inference done 2011/2919. Dataloading: 0.0031 s/iter. Inference: 0.0388 s/iter. Eval: 0.0058 s/iter. Total: 0.0478 s/iter. ETA=0:00:43
[02/29 17:32:53 d2.evaluation.evaluator]: Inference done 2116/2919. Dataloading: 0.0031 s/iter. Inference: 0.0388 s/iter. Eval: 0.0058 s/iter. Total: 0.0478 s/iter. ETA=0:00:38
[02/29 17:32:58 d2.evaluation.evaluator]: Inference done 2217/2919. Dataloading: 0.0031 s/iter. Inference: 0.0389 s/iter. Eval: 0.0059 s/iter. Total: 0.0479 s/iter. ETA=0:00:33
[02/29 17:33:03 d2.evaluation.evaluator]: Inference done 2322/2919. Dataloading: 0.0031 s/iter. Inference: 0.0388 s/iter. Eval: 0.0059 s/iter. Total: 0.0479 s/iter. ETA=0:00:28
[02/29 17:33:08 d2.evaluation.evaluator]: Inference done 2420/2919. Dataloading: 0.0030 s/iter. Inference: 0.0388 s/iter. Eval: 0.0061 s/iter. Total: 0.0480 s/iter. ETA=0:00:23
[02/29 17:33:13 d2.evaluation.evaluator]: Inference done 2506/2919. Dataloading: 0.0030 s/iter. Inference: 0.0389 s/iter. Eval: 0.0063 s/iter. Total: 0.0484 s/iter. ETA=0:00:19
[02/29 17:33:18 d2.evaluation.evaluator]: Inference done 2602/2919. Dataloading: 0.0030 s/iter. Inference: 0.0389 s/iter. Eval: 0.0065 s/iter. Total: 0.0485 s/iter. ETA=0:00:15
[02/29 17:33:23 d2.evaluation.evaluator]: Inference done 2723/2919. Dataloading: 0.0030 s/iter. Inference: 0.0386 s/iter. Eval: 0.0065 s/iter. Total: 0.0482 s/iter. ETA=0:00:09
[02/29 17:33:29 d2.evaluation.evaluator]: Inference done 2762/2919. Dataloading: 0.0030 s/iter. Inference: 0.0399 s/iter. Eval: 0.0064 s/iter. Total: 0.0495 s/iter. ETA=0:00:07
[02/29 17:33:34 d2.evaluation.evaluator]: Inference done 2877/2919. Dataloading: 0.0030 s/iter. Inference: 0.0397 s/iter. Eval: 0.0064 s/iter. Total: 0.0492 s/iter. ETA=0:00:02
[02/29 17:33:35 d2.evaluation.evaluator]: Total inference time: 0:02:23.234767 (0.049154 s / iter per device, on 1 devices)
[02/29 17:33:35 d2.evaluation.evaluator]: Total inference pure compute time: 0:01:55 (0.039669 s / iter per device, on 1 devices)
[02/29 17:33:36 d2.evaluation.coco_evaluation]: Preparing results for COCO format ...
[02/29 17:33:36 d2.evaluation.coco_evaluation]: Saving results to outputs_prueba/COCO-InstanceSegmentation/coco_instances_results.json
[02/29 17:33:36 d2.evaluation.coco_evaluation]: Evaluating predictions with unofficial COCO API...
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
[02/29 17:33:36 d2.evaluation.fast_eval_api]: Evaluate annotation type *bbox*
[02/29 17:33:40 d2.evaluation.fast_eval_api]: COCOeval_opt.evaluate() finished in 3.82 seconds.
[02/29 17:33:40 d2.evaluation.fast_eval_api]: Accumulating evaluation results...
[02/29 17:33:40 d2.evaluation.fast_eval_api]: COCOeval_opt.accumulate() finished in 0.43 seconds.
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.387
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.538
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.444
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.268
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.457
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.448
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.134
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.445
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.452
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.354
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.507
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.598
[02/29 17:33:40 d2.evaluation.coco_evaluation]: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 38.733 | 53.834 | 44.448 | 26.822 | 45.662 | 44.796 |
[02/29 17:33:40 d2.evaluation.coco_evaluation]: Per-category bbox AP: 
| category   | AP     | category   | AP   | category   | AP     |
|:-----------|:-------|:-----------|:-----|:-----------|:-------|
| pedestrian | 47.546 |            | nan  | car        | 68.652 |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  | sink       | 0.000  |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  | background | nan    |
Loading and preparing results...
DONE (t=0.20s)
creating index...
index created!
[02/29 17:33:41 d2.evaluation.fast_eval_api]: Evaluate annotation type *segm*
[02/29 17:33:44 d2.evaluation.fast_eval_api]: COCOeval_opt.evaluate() finished in 3.55 seconds.
[02/29 17:33:45 d2.evaluation.fast_eval_api]: Accumulating evaluation results...
[02/29 17:33:45 d2.evaluation.fast_eval_api]: COCOeval_opt.accumulate() finished in 0.63 seconds.
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.351
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.532
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.388
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.212
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.420
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.481
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.120
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.407
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.412
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.304
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.472
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.552
[02/29 17:33:46 d2.evaluation.coco_evaluation]: Evaluation results for segm: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 35.056 | 53.167 | 38.829 | 21.155 | 41.951 | 48.090 |
[02/29 17:33:46 d2.evaluation.coco_evaluation]: Per-category segm AP: 
| category   | AP     | category   | AP   | category   | AP     |
|:-----------|:-------|:-----------|:-----|:-----------|:-------|
| pedestrian | 38.162 |            | nan  | car        | 67.006 |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  | sink       | 0.000  |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  |            | nan    |
|            | nan    |            | nan  | background | nan    |
OrderedDict([('bbox', {'AP': 38.73287856270913, 'AP50': 53.83443826018532, 'AP75': 44.4482830367766, 'APs': 26.821556660936817, 'APm': 45.6624397937315, 'APl': 44.795778933657886, 'AP-pedestrian': 47.546254936308415, 'AP-': nan, 'AP-car': 68.652380751819, 'AP-sink': 0.0, 'AP-background': nan}), ('segm', {'AP': 35.05615920198949, 'AP50': 53.167064324904935, 'AP75': 38.82928428604728, 'APs': 21.154804201180035, 'APm': 41.950814406046696, 'APl': 48.0896825656751, 'AP-pedestrian': 38.16219545889909, 'AP-': nan, 'AP-car': 67.0062821470694, 'AP-sink': 0.0, 'AP-background': nan})])
